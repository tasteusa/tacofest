jQuery(window).ready(function(s){s("#skystats-settings-accordion").accordion({animate:"swing",collapsible:!0,header:"h3",heightStyle:"content",icons:{header:"skystats-accordion-header-icon",activeHeader:"skystats-accordion-header-active-icon"},create:function(e,t){s("#skystats_reports_users_allowed_access").chosen({width:"100%"}),s("#skystats_settings_users_allowed_access").chosen({width:"100%"})}}),s("#validate_license").click(function(e){e.preventDefault();var t=s("#skystats-settings-validate-license-loading-container"),a=s("#skystats-successful-license-validation-request"),n=s("#skystats-unsuccessful-license-validation-request"),i=s(this),r=s("#license_key").val();a.add(n).add(i).fadeOut(400).promise().done(function(){t.fadeIn(400,function(){s.get(ajaxurl,{action:"skystats_ajax_licensing_validate_license",license_key:r},function(e){if(e=s.parseJSON(e),"success"===e.responseType){switch(s.post(ajaxurl,{action:"skystats_ajax_licensing_save_license_type",license_type:e.data.licenseType}),e.responseContext){case"license_activated":a.html(skystats_settings.trans.licensing.license_activated);break;case"license_valid":default:a.html(skystats_settings.trans.licensing.license_valid)}t.fadeOut(400,function(){a.fadeIn(),i.fadeIn()})}else if("error"===e.responseType){switch(e.responseContext){case"license_invalid":n.html(skystats_settings.trans.licensing.license_invalid);break;case"missing_license_key":n.html(skystats_settings.trans.licensing.missing_license_key);break;case"error_initializing_request":n.html(skystats_settings.trans.licensing.error_initializing_request);break;case"error_executing_request":n.html(skystats_settings.trans.licensing.error_executing_request);break;case"malformed_response":n.html(skystats_settings.trans.licensing.malformed_response);break;case"license_site_inactive_no_activations_left":n.html(skystats_settings.trans.licensing.license_site_inactive_no_activations_left);break;case"license_site_inactive_activation_error":n.html(skystats_settings.trans.licensing.license_site_inactive_activation_error);break;case"license_inactive_no_activations_left":n.html(skystats_settings.trans.licensing.license_inactive_no_activations_left);break;case"license_inactive_activation_error":n.html(skystats_settings.trans.licensing.license_inactive_activation_error);break;case"license_expired":var c=skystats_settings.trans.licensing.license_expired;c=c.replace("{LICENSE_KEY}",r),n.html(c);break;case"license_disabled":n.html(skystats_settings.trans.licensing.license_disabled);break;case"http_error":n.html(skystats_settings.trans.licensing.http_error);break;case"license_unknown_status":default:n.html(skystats_settings.trans.licensing.license_unknown_status)}t.fadeOut(400,function(){n.fadeIn(),i.fadeIn()})}})})})});var e=[],t=[],a=[];s(".skystats-upload-image").each(function(n,i){var r=s(i),c=r.prev(),_=s(".skystats-loading-container").first().clone();_.attr("id",""),_.attr("style","margin-top: 10px;"),e[n]=r,t[n]=c,a[n]=c.parent().prev().children().first(),r.fileupload({dataType:"json",formData:{action:"skystats_ajax_upload_image"},url:ajaxurl,add:function(s,e){t[n].hide(),_.insertAfter(t[n]),_.show(),e.submit()},done:function(s,e){var i=e.result;_.remove(),i&&a[n].val(i),t[n].show()}})}),s("#save_settings").click(function(e){e.preventDefault();var t={};s("input[name='skystats_mashboard_cards_visiblity_status[]']").each(function(){t[s(this).val()]=1==this.checked?"1":"0"});var a=s("#skystats-settings-save-settings-loading-container"),n=s(this),i=s("#skystats-save-settings-result");a.show(),n.add(i).fadeOut(400).promise().done(function(){a.fadeIn(400,function(){s.post(ajaxurl,{action:"skystats_ajax_settings_save_settings",brand_name:s("#brand_name").val(),brand_menu_name:s("#brand_menu_name").val(),brand_logo_image_url:s("#brand_logo_image_url").val(),brand_background_image_url:s("#brand_background_image_url").val(),brand_background_color:s("#brand_background_color").val(),skystats_date_range_label_color:s("#skystats_date_range_label_color").val(),default_dashboard:s("#default_dashboard").val(),cache_mode:s("#cache_mode").val(),mashboard_cards_visibility_status:t,skystats_reports_users_allowed_access:s("#skystats_reports_users_allowed_access").val(),skystats_mashboard_menu_name:s("#skystats_mashboard_menu_name").val(),skystats_settings_users_allowed_access:s("#skystats_settings_users_allowed_access").val()},function(){a.fadeOut(400,function(){i.add(n).fadeIn(400).promise().done(function(){})})})})})}),skystats_settings.wp_version>="3.5"?(s("#brand_background_color").wpColorPicker(),s("#skystats_date_range_label_color").wpColorPicker()):(s("#brand_background_color").ColorPicker({onChange:function(e,t,a,n){s("#brand_background_color").val("#"+t)},onSubmit:function(e,t,a,n){var i=s(n);i.val("#"+t),i.ColorPickerHide()}}),s("#skystats_date_range_label_color").ColorPicker({onChange:function(e,t,a,n){s("#skystats_date_range_label_color").val("#"+t)},onSubmit:function(e,t,a,n){var i=s(n);i.val("#"+t),i.ColorPickerHide()}}))});